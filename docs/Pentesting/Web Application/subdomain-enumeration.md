---
description: >-
  Below are some references for the subdomain enumeration and if vulnerable how
  to takeover.
---

# **Subdomain Enumeration & Takeover** #

### **Subdomain Enumeration** ###

Subdomain enumeration is the process of finding valid subdomains for one or more domains & Subdomain takeover is a process of registering a non-existing domain name to gain control over another domain.

### **Subdomain Takeover** ###

Use the following tools to enumerate subdomains


Some basic's below

#### **DNS** ####

[![DNS](https://github.com/Hacker22o2/HowToHunt/raw/master/Subdomain\_Takeover/dns.png)](https://github.com/Hacker22o2/HowToHunt/blob/master/Subdomain\_Takeover/dns.png)

* When a web address is accessed eg. "[www.xyz.com](http://www.xyz.com/)", a DNS query is performed across a DNS server with the host name.
* The DNS server takes the hostname and resolves it into a numeric IP address

#### **CNAME** ####

[![CNAME](https://github.com/Hacker22o2/HowToHunt/raw/master/Subdomain\_Takeover/cname.png)](https://github.com/Hacker22o2/HowToHunt/blob/master/Subdomain\_Takeover/cname.png)

* An alias of domain name to another domain name
* In the example below, xyz.company.com is a source domain and xyz.cloudservice.com is a canonical domain name.

[![Subtakeover\_basics](https://github.com/Hacker22o2/HowToHunt/raw/master/Subdomain\_Takeover/subdomain\_takeover.png)](https://github.com/Hacker22o2/HowToHunt/blob/master/Subdomain\_Takeover/subdomain\_takeover.png)

* Subdomains map themselves to a specific IP, 3rd party services like Azure, AWS, Heroku, Github, Fastly, Shopify, etc. to serve the contents. These subdomains use a CNAME record to another domain \[eg. xyz.company.com CNAME xyz.cloudservice.com]
* Now due to whatever reason, the company decides to stop utilizing this service and to save some bucks, the company cancels the subscription of the 3rd party cloud service provider.
* But, the company forgets to update or simply remove the CNAME record in the DNS zone file
* Since the CNAME record is not deleted from company.com DNS zone, anyone who registers xyz.cloudservice.com has full control over xyz.company.com until the DNS record is present.

### **Case : CNAME available to buy** ###

[![CNAME available to buy](https://github.com/Hacker22o2/HowToHunt/raw/master/Subdomain\_Takeover/cname\_buy.png)](https://github.com/Hacker22o2/HowToHunt/blob/master/Subdomain\_Takeover/cname\_buy.png)

* There are cases when the CNAME that a subdomain points to, is available to buy.
* In that case the attacker can directly buy that domain and host his/her content.

### **Enumeration tools** ###

Use the following tools to enumerate subdomains

- [https://github.com/OWASP/Amass/](https://github.com/OWASP/Amass/)

- [https://github.com/michenriksen/aquatone](https://github.com/michenriksen/aquatone)

- [https://github.com/Edu4rdSHL/findomain](https://github.com/Edu4rdSHL/findomain)

- [https://github.com/blechschmidt/massdns](https://github.com/blechschmidt/massdns)

- [https://github.com/tomnomnom/assetfinder](https://github.com/tomnomnom/assetfinder)

### **Takeover tools** ###

The following tools are designed to scan a list of subdomains concurrently and identify ones that are able to be hijacked.

- [https://github.com/anshumanbh/tko-subs](https://github.com/anshumanbh/tko-subs)

- [https://github.com/haccer/subjack](https://github.com/haccer/subjack)

- [https://github.com/shmilylty/OneForAll](https://github.com/shmilylty/OneForAll)

- [https://github.com/smaranchand/bucky](https://github.com/smaranchand/bucky)

- [https://github.com/mxm0z/awesome-sec-s3](https://github.com/mxm0z/awesome-sec-s3)
S3buckets tools


### **Subdomain Takeover POC's** ###

| Engine               | Status         | Fingerprint                                                                                            | Discussion                                                                                                                                         | Documentation                                                                                                                                                    |
| -------------------- | -------------- | ------------------------------------------------------------------------------------------------------ | -------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Agile CRM            | Vulnerable     | `Sorry, this page is no longer available.`                                                             | [Issue #145](https://github.com/EdOverflow/can-i-take-over-xyz/issues/145)                                                                         |                                                                                                                                                                  |
| Airee.ru             | Vulnerable     |                                                                                                        | [Issue #104](https://github.com/EdOverflow/can-i-take-over-xyz/issues/104)                                                                         |                                                                                                                                                                  |
| Anima                | Vulnerable     | `If this is your website and you've just created it, try refreshing in a minute`                       | [Issue #126](https://github.com/EdOverflow/can-i-take-over-xyz/issues/126)                                                                         | [Anima Documentation](https://docs.animaapp.com/v1/launchpad/08-custom-domain.html)                                                                              |
| Akamai               | Not vulnerable |                                                                                                        | [Issue #13](https://github.com/EdOverflow/can-i-take-over-xyz/issues/13)                                                                           |                                                                                                                                                                  |
| AWS/S3               | Vulnerable     | `The specified bucket does not exist`                                                                  | [Issue #36](https://github.com/EdOverflow/can-i-take-over-xyz/issues/36)                                                                           |                                                                                                                                                                  |
| Bitbucket            | Vulnerable     | `Repository not found`                                                                                 |                                                                                                                                                    |                                                                                                                                                                  |
| Campaign Monitor     | Vulnerable     | `Trying to access your account?`                                                                       |                                                                                                                                                    | [Support Page](https://help.campaignmonitor.com/custom-domain-names)                                                                                             |
| Cargo Collective     | Vulnerable     | `404 Not Found`                                                                                        |                                                                                                                                                    | [Cargo Support Page](https://support.2.cargocollective.com/Using-a-Third-Party-Domain)                                                                           |
| Cloudfront           | Not vulnerable | ViewerCertificateException                                                                             | [Issue #29](https://github.com/EdOverflow/can-i-take-over-xyz/issues/29)                                                                           | [Domain Security on Amazon CloudFront](https://aws.amazon.com/blogs/networking-and-content-delivery/continually-enhancing-domain-security-on-amazon-cloudfront/) |
| Desk                 | Not vulnerable | `Please try again or try Desk.com free for 14 days.`                                                   | [Issue #9](https://github.com/EdOverflow/can-i-take-over-xyz/issues/9)                                                                             |                                                                                                                                                                  |
| Digital Ocean        | Vulnerable     | Domain uses DO name serves with no records in DO.                                                      |                                                                                                                                                    |                                                                                                                                                                  |
| Fastly               | Edge case      | `Fastly error: unknown domain:`                                                                        | [Issue #22](https://github.com/EdOverflow/can-i-take-over-xyz/issues/22)                                                                           |                                                                                                                                                                  |
| Feedpress            | Vulnerable     | `The feed has not been found.`                                                                         | [HackerOne #195350](https://hackerone.com/reports/195350)                                                                                          |                                                                                                                                                                  |
| Firebase             | Not vulnerable |                                                                                                        | [Issue #128](https://github.com/EdOverflow/can-i-take-over-xyz/issues/128)                                                                         |                                                                                                                                                                  |
| Fly.io               | Vulnerable     | `404 Not Found`                                                                                        | [Issue #101](https://github.com/EdOverflow/can-i-take-over-xyz/issues/101)                                                                         |                                                                                                                                                                  |
| Freshdesk            | Not vulnerable |                                                                                                        |                                                                                                                                                    | [Freshdesk Support Page](https://support.freshdesk.com/support/solutions/articles/37590-using-a-vanity-support-url-and-pointing-the-cname)                       |
| Gemfury              | Vulnerable     | `404: This page could not be found.`                                                                   | [Issue #154](https://github.com/EdOverflow/can-i-take-over-xyz/issues/154)                                                                         | [Article](https://khaledibnalwalid.wordpress.com/2020/06/25/gemfury-subdomain-takeover/)                                                                         |
| Ghost                | Vulnerable     | `The thing you were looking for is no longer here, or never was`                                       |                                                                                                                                                    |                                                                                                                                                                  |
| Github               | Vulnerable     | `There isn't a Github Pages site here.`                                                                | [Issue #37](https://github.com/EdOverflow/can-i-take-over-xyz/issues/37) [Issue #68](https://github.com/EdOverflow/can-i-take-over-xyz/issues/68)  |                                                                                                                                                                  |
| Gitlab               | Not vulnerable |                                                                                                        | [HackerOne #312118](https://hackerone.com/reports/312118)                                                                                          |                                                                                                                                                                  |
| Google Cloud Storage | Not vulnerable |                                                                                                        |                                                                                                                                                    |                                                                                                                                                                  |
| HatenaBlog           | vulnerable     | `404 Blog is not found`                                                                                |                                                                                                                                                    |                                                                                                                                                                  |
| Help Juice           | Vulnerable     | `We could not find what you're looking for.`                                                           |                                                                                                                                                    | [Help Juice Support Page](https://help.helpjuice.com/34339-getting-started/custom-domain)                                                                        |
| Help Scout           | Vulnerable     | `No settings were found for this company:`                                                             |                                                                                                                                                    | [HelpScout Docs](https://docs.helpscout.net/article/42-setup-custom-domain)                                                                                      |
| Heroku               | Edge case      | `No such app`                                                                                          | [Issue #38](https://github.com/EdOverflow/can-i-take-over-xyz/issues/38)                                                                           |                                                                                                                                                                  |
| Instapage            | Not vulnerable |                                                                                                        | [Issue #73](https://github.com/EdOverflow/can-i-take-over-xyz/issues/73)                                                                           |                                                                                                                                                                  |
| Intercom             | Vulnerable     | `Uh oh. That page doesn't exist.`                                                                      | [Issue #69](https://github.com/EdOverflow/can-i-take-over-xyz/issues/69)                                                                           | [Help center](https://www.intercom.com/help/)                                                                                                                    |
| JetBrains            | Vulnerable     | `is not a registered InCloud YouTrack`                                                                 |                                                                                                                                                    | [YouTrack InCloud Help Page](https://www.jetbrains.com/help/youtrack/incloud/Domain-Settings.html)                                                               |
| Key CDN              | Not vulnerable |                                                                                                        | [Issue #112](https://github.com/EdOverflow/can-i-take-over-xyz/issues/112)                                                                         |                                                                                                                                                                  |
| Kinsta               | Vulnerable     | `No Site For Domain`                                                                                   | [Issue #48](https://github.com/EdOverflow/can-i-take-over-xyz/issues/48)                                                                           | [kinsta-add-domain](https://kinsta.com/knowledgebase/add-domain/)                                                                                                |
| LaunchRock           | Vulnerable     | `It looks like you may have taken a wrong turn somewhere. Don't worry...it happens to all of us.`      | [Issue #74](https://github.com/EdOverflow/can-i-take-over-xyz/issues/74)                                                                           |                                                                                                                                                                  |
| Mashery              | Edge Case      | `Unrecognized domain`                                                                                  | [HackerOne #275714](https://hackerone.com/reports/275714), [Issue #14](https://github.com/EdOverflow/can-i-take-over-xyz/issues/14)                |                                                                                                                                                                  |
| Microsoft Azure      | Vulnerable     |                                                                                                        | [Issue #35](https://github.com/EdOverflow/can-i-take-over-xyz/issues/35)                                                                           |                                                                                                                                                                  |
| Netlify              | Edge Case      |                                                                                                        | [Issue #40](https://github.com/EdOverflow/can-i-take-over-xyz/issues/40)                                                                           |                                                                                                                                                                  |
| Ngrok                | Vulnerable     | `Tunnel *.ngrok.io not found`                                                                          | [Issue #92](https://github.com/EdOverflow/can-i-take-over-xyz/issues/92)                                                                           | [Ngrok Documentation](https://ngrok.com/docs#http-custom-domains)                                                                                                |
| Pantheon             | Vulnerable     | `404 error unknown site!`                                                                              | [Issue #24](https://github.com/EdOverflow/can-i-take-over-xyz/issues/24)                                                                           | [Pantheon-Sub-takeover](https://medium.com/@hussain\_0x3c/hostile-subdomain-takeover-using-pantheon-ebf4ab813111)                                                |
| Pingdom              | Vulnerable     | `This public report page has not been activated by the user`                                           | [Issue #144](https://github.com/EdOverflow/can-i-take-over-xyz/issues/144)                                                                         | [Support Page](https://help.pingdom.com/hc/en-us/articles/205386171-Public-Status-Page)                                                                          |
| Readme.io            | Vulnerable     | `Project doesnt exist... yet!`                                                                         | [Issue #41](https://github.com/EdOverflow/can-i-take-over-xyz/issues/41)                                                                           |                                                                                                                                                                  |
| Sendgrid             | Not vulnerable |                                                                                                        |                                                                                                                                                    |                                                                                                                                                                  |
| Shopify              | Edge Case      | `Sorry, this shop is currently unavailable.`                                                           | [Issue #32](https://github.com/EdOverflow/can-i-take-over-xyz/issues/32), [Issue #46](https://github.com/EdOverflow/can-i-take-over-xyz/issues/46) | [Medium Article](https://medium.com/@thebuckhacker/how-to-do-55-000-subdomain-takeover-in-a-blink-of-an-eye-a94954c3fc75)                                        |
| SmartJobBoard        | Vulnerable     | `This job board website is either expired or its domain name is invalid.`                              | [Issue #139](https://github.com/EdOverflow/can-i-take-over-xyz/issues/139)                                                                         | [Support Page](https://help.smartjobboard.com/en/articles/1269655-connecting-a-custom-domain-name)                                                               |
| Squarespace          | Not vulnerable |                                                                                                        |                                                                                                                                                    |                                                                                                                                                                  |
| Statuspage           | Vulnerable     | Visiting the subdomain will redirect users to [https://www.statuspage.io](https://www.statuspage.io/). | [PR #105](https://github.com/EdOverflow/can-i-take-over-xyz/pull/105)                                                                              | [Statuspage documentation](https://help.statuspage.io/knowledge\_base/topics/domain-ownership)                                                                   |
| Strikingly           | Vulnerable     | `page not found`                                                                                       | [Issue #58](https://github.com/EdOverflow/can-i-take-over-xyz/issues/58)                                                                           | [Strikingly-Sub-takeover](https://medium.com/@sherif0x00/takeover-subdomains-pointing-to-strikingly-5e67df80cdfd)                                                |
| Surge.sh             | Vulnerable     | `project not found`                                                                                    |                                                                                                                                                    | [Surge Documentation](https://surge.sh/help/adding-a-custom-domain)                                                                                              |
| Tumblr               | Edge Case      | `Whatever you were looking for doesn't currently exist at this address`                                |                                                                                                                                                    |                                                                                                                                                                  |
| Tilda                | Edge Case      | `Please renew your subscription`                                                                       | [PR #20](https://github.com/EdOverflow/can-i-take-over-xyz/pull/20)                                                                                |                                                                                                                                                                  |
| Uberflip             | Vulnerable     | `Non-hub domain, The URL you've accessed does not provide a hub.`                                      | [Issue #150](https://github.com/EdOverflow/can-i-take-over-xyz/issues/150)                                                                         | [Uberflip Documentation](https://help.uberflip.com/hc/en-us/articles/360018786372-Custom-Domain-Set-up-Your-Hub-on-a-Subdomain)                                  |
| Unbounce             | Edge Case      | `The requested URL was not found on this server.`                                                      | [Issue #11](https://github.com/EdOverflow/can-i-take-over-xyz/issues/11)                                                                           |                                                                                                                                                                  |
| Uptimerobot          | Vulnerable     | `page not found`                                                                                       | [Issue #45](https://github.com/EdOverflow/can-i-take-over-xyz/issues/45)                                                                           | [Uptimerobot-Sub-takeover](https://exploit.linuxsec.org/uptimerobot-com-custom-domain-subdomain-takeover/)                                                       |
| UserVoice            | Vulnerable     | `This UserVoice subdomain is currently available!`                                                     |                                                                                                                                                    |                                                                                                                                                                  |
| Webflow              | Edge Case      | `The page you are looking for doesn't exist or has been moved.`                                        | [Issue #44](https://github.com/EdOverflow/can-i-take-over-xyz/issues/44)                                                                           | [forum webflow](https://forum.webflow.com/t/hosting-a-subdomain-on-webflow/59201)                                                                                |
| Wordpress            | Vulnerable     | `Do you want to register *.wordpress.com?`                                                             |                                                                                                                                                    |                                                                                                                                                                  |
| Worksites            | Vulnerable     | `Hello! Sorry, but the website you&rsquo;re looking for doesn&rsquo;t exist.`                          | [Issue #142](https://github.com/EdOverflow/can-i-take-over-xyz/issues/142)                                                                         |                                                                                                                                                                  |
| WP Engine            | Not vulnerable |                                                                                                        |                                                                                                                                                    |                                                                                                                                                                  |
| Zendesk              | Not vulnerable | `Help Center Closed`                                                                                   | [Issue #23](https://github.com/EdOverflow/can-i-take-over-xyz/issues/23)                                                                           | [Zendesk Support](https://support.zendesk.com/hc/en-us/articles/203664356-Changing-the-address-of-your-Help-Center-subdomain-host-mapping-)                      |

### **References** ###
- [https://www.notion.so/Subdomain-Enumaration-5109690b9db14b41b02b373af8234c93](https://www.notion.so/Subdomain-Enumaration-5109690b9db14b41b02b373af8234c93)

- [https://blog.sweepatic.com/art-of-subdomain-enumeration/](https://blog.sweepatic.com/art-of-subdomain-enumeration/)

- [https://t.co/DHOPzXoeAc?amp=1](https://t.co/DHOPzXoeAc?amp=1)

- [https://0xpatrik.com/](https://0xpatrik.com/)

- [https://github.com/EdOverflow/can-i-take-over-xyz](https://github.com/EdOverflow/can-i-take-over-xyz)

- [https://www.youtube.com/watch?v=xCunHBH8ZQ4](https://www.youtube.com/watch?v=xCunHBH8ZQ4)

